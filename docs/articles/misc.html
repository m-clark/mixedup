<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Miscellaneous Functions • mixedup</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Miscellaneous Functions">
<meta property="og:description" content="mixedup">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mixedup</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/variance_components.html">Variance Components</a>
    </li>
    <li>
      <a href="../articles/random_effects.html">Random Effects</a>
    </li>
    <li>
      <a href="../articles/fixed_effects.html">Fixed Effects</a>
    </li>
    <li>
      <a href="../articles/random_coefficients.html">Random Coefficients</a>
    </li>
    <li>
      <a href="../articles/summarize_model.html">Summarize Model</a>
    </li>
    <li>
      <a href="../articles/misc.html">Miscellaneous</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/m-clark">
    <span class="fa fa-github-alt"></span>
     
  </a>
</li>
<li>
  <a href="https://m-clark.github.io">
    <span class="fa fa-empire"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="misc_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Miscellaneous Functions</h1>
                        <h4 class="author">Michael Clark</h4>
            
            <h4 class="date"><span style="font-style:normal;font-family:'Open Sans'">2020-06-24</span></h4>
      
      <small class="dont-index">Source: <a href="https://github.com/m-clark/mixedup/blob/master/vignettes/misc.Rmd"><code>vignettes/misc.Rmd</code></a></small>
      <div class="hidden name"><code>misc.Rmd</code></div>

    </div>

    
    
<div id="intro" class="section level2">
<h2 class="hasAnchor">
<a href="#intro" class="anchor"></a>Intro</h2>
<p>Miscellaneous functions are included to fill a need.</p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="find-typical-values" class="section level3">
<h3 class="hasAnchor">
<a href="#find-typical-values" class="anchor"></a>Find typical values</h3>
<p>In many cases, predictions are made by holding the random effects to zero, which can be seen as the typical case. When the clusters carry substantive meaning, for example, school, country, or hospital, it might be of interest to note which are most ‘typical’, or at any other value relative to their peers. This will work for any model to which <code>extract_random_effects</code> applies.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">library(lme4)

lmer_model &lt;- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(mixedup)

find_typical(lmer_model)  # closest RE to zero
# A tibble: 2 x 7
  group_var effect    group  value    se lower_2.5 upper_97.5
  &lt;chr&gt;     &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1 Subject   Days      333   -0.224  2.31     -4.74       4.29
2 Subject   Intercept 335   -0.334 12.1     -24.0       23.3 


find_typical(lmer_model, probs = c(.1, .9))
# A tibble: 4 x 8
  group_var effect    group  value    se lower_2.5 upper_97.5 probs
  &lt;chr&gt;     &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;
1 Subject   Days      310    -5.45  2.31     -9.97     -0.931 10%  
2 Subject   Days      350     6.61  2.31      2.10     11.1   90%  
3 Subject   Intercept 370   -25.6  12.1     -49.3      -1.96  10%  
4 Subject   Intercept 331    22.3  12.1      -1.40     45.9   90%  </pre></body></html></div>
</div>
<div id="extract-heterogeneous-variances" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-heterogeneous-variances" class="anchor"></a>Extract heterogeneous variances</h3>
<p>For <code>nlme</code>, only models with <code>varIdent</code> have been tested. For <span class="pack" style="">glmmTMB</span>, this applies to models that use the <span class="func" style="">diag</span> function in the formula.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">library(nlme)

lme_1 &lt;- lme(
  distance ~ scale(age) + Sex,
  data = Orthodont,
  random = ~ 1 | Subject,
  weights = varIdent(form = ~ 1 | Sex)
)

extract_het_var(lme_1)
   Male Female
1 1.762    0.8</pre></body></html></div>
<p>May include <span class="pack" style="">brms</span> at some point, but for these, you can extract any parameters associated with sigma model for distributional models using the <code>component</code> argument of the other standard functions.</p>
</div>
<div id="extract-correlation-structure" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-correlation-structure" class="anchor"></a>Extract correlation structure</h3>
<p>With some packages one can estimate the residual correlation structure. Right now this works for <span class="pack" style="">nlme</span>, <span class="pack" style="">glmmTMB</span>, and <span class="pack" style="">brms</span> objects.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">base_model &lt;-
  lme(Reaction ~ Days,
      random = ~ 1 + Days | Subject,
      data = sleepstudy)

lme_corSymm &lt;-
  update(
    base_model,
    corr = corSymm(form = ~ 1 | Subject),
    data = dplyr::filter(sleepstudy, Days &lt; 5)
  )

lme_corAR &lt;-
  update(
    base_model,
    corr = corAR1(form = ~ Days),
    data = dplyr::filter(sleepstudy, Days &lt; 5)
  )


extract_cor_structure(lme_corSymm)
       V1    V2     V3     V4     V5
V1  1.000 0.263 -0.460 -0.222 -0.092
V2  0.263 1.000  0.272  0.356  0.081
V3 -0.460 0.272  1.000  0.377 -0.417
V4 -0.222 0.356  0.377  1.000  0.572
V5 -0.092 0.081 -0.417  0.572  1.000


extract_cor_structure(lme_corAR)
# A tibble: 1 x 1
    Phi
  &lt;dbl&gt;
1 0.662</pre></body></html></div>
</div>
<div id="extract-model-data" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-model-data" class="anchor"></a>Extract model data</h3>
<p>Just a wrapper for <code>model.frame</code>.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r">extract_model_data(lmer_model)
# A tibble: 180 x 3
   Reaction  Days Subject
      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  
 1     250.     0 308    
 2     259.     1 308    
 3     251.     2 308    
 4     321.     3 308    
 5     357.     4 308    
 6     415.     5 308    
 7     382.     6 308    
 8     290.     7 308    
 9     431.     8 308    
10     466.     9 308    
# … with 170 more rows</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://m-clark.github.io"><img src="man/figures/mc_logo.png" width="10%" style="display:inline"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
