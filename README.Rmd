---
output: 
  github_document:
    toc: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = NA,
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mixedup

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/m-clark/mixedup.svg?branch=master)](https://travis-ci.org/m-clark/mixedup)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/m-clark/mixedup?branch=master&svg=true)](https://ci.appveyor.com/project/m-clark/mixedup)
[![Codecov test coverage](https://codecov.io/gh/m-clark/mixedup/branch/master/graph/badge.svg)](https://codecov.io/gh/m-clark/mixedup?branch=master)
<!-- badges: end -->

Provides extended functionality for mixed models. The goal of mixedup is to solve little problems that slip through the cracks from the various packages, broom, and others.  Basically the idea is to create objects that are easy to use and mostly ready for presentation.

## Installation

You can install mixedup from GitHub with `devtools`:

``` r
devtools::install_github('m-clark/mixedup')
```

## Feature list

##### Extract Variance Components

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] brms

##### Extract Random Effects

- [X] lme4
- [X] glmmTMB
- [X] nlme

##### Extract Random Coefficients

- [X] lme4
- [X] glmmTMB
- [X] nlme

##### Extract Heterogeneous Variances

- [ ] glmmTMB
- [X] nlme

##### Find Typical

- [ ] lme4
- [ ] glmmTMB
- [ ] nlme


Just a note, <span class="pack" style = "">nlme</span> has pretty much been superseded by <span class="pack" style = "">glmmTMB</span>, <span class="pack" style = "">brms</span>, and others, so support here is pretty minimal.

## Examples

### Setup

```{r mods}
library(lme4)

lmer_1 <- lmer(Reaction ~ Days + (1 | Subject), data = sleepstudy)
lmer_2 <- lmer(Reaction ~ Days + (1 + Days| Subject), data = sleepstudy)

library(glmmTMB)

tmb_1 <- glmmTMB(Reaction ~ Days + (1 | Subject), data = sleepstudy)
tmb_2 <- glmmTMB(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(nlme)

nlme_1 <-  nlme(
  height ~ SSasymp(age, Asym, R0, lrc),
  data = Loblolly,
  fixed = Asym + R0 + lrc ~ 1,
  random = Asym ~ 1,
  start = c(Asym = 103, R0 = -8.5, lrc = -3.3)
)

library(brms)

brm_1 = brm(Reaction ~ Days + (1 + Days| Subject), data = sleepstudy, refresh = -1)
```


### Extract random effects

Extract the random effects with their (not necessarily valid) standard errors from model objects.

```{r extract-re}
library(mixedup)

extract_random_effects(lmer_1, re = 'Subject')


extract_random_effects(lmer_2, re = 'Subject')
```


### Extract random coefficients

Extract the random coefficients with their standard errors model objects.


```{r coefs}
extract_random_coef(lmer_1, re = 'Subject')


extract_random_coef(tmb_2,  re = 'Subject')
```


### Extract variance components

```{r vc}
extract_vc(lmer_2)


extract_vc(lmer_2, ci_scale = 'var', show_cor = TRUE, digits = 2)


extract_vc(nlme_1)


extract_vc(brm_1)
```


### Extract heterogeneous variances

Extract heterogeneous variances from nlme (and eventually others), which only reports the relative standard deviation values by default.

```{r nlme}
library(nlme)

model <- lme(
  distance ~ age + Sex, 
  data = Orthodont, 
  random = ~ 1|Subject,
  weights = varIdent(form = ~ 1 | Sex)
)

summary(model)

extract_nlme_variances(model)
```


## Other stuff

### Code of Conduct

Please note that the 'mixedup' project is released with a [Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md).

By contributing to this project, you agree to abide by its terms.

