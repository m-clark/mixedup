---
output: 
  github_document:
    # toc: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = NA,
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mixedup

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/m-clark/mixedup.svg?branch=master)](https://travis-ci.org/m-clark/mixedup)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/m-clark/mixedup?branch=master&svg=true)](https://ci.appveyor.com/project/m-clark/mixedup)
[![Codecov test coverage](https://codecov.io/gh/m-clark/mixedup/branch/master/graph/badge.svg)](https://codecov.io/gh/m-clark/mixedup?branch=master)
<!-- badges: end -->

This package provides extended functionality for mixed models. The goal of `mixedup` is to solve little problems that slip through the cracks from the various packages, broom, and others in trying to get presentable output.  Basically the idea is to create (tidy) objects that are easy to use and essentially ready for presentation, as well as consistent across packages and across functions.  I use several of these packages (including mgcv) for mixed models, and typically have to some notable post processing to get some basic output even with `broom::tidy` options, and this effort often isn't applicable if I switch to another package for the same model.  These functions attempt to fill my specific niche.

An additional perk is minimal dependency.  Other than the package that created the object, nothing except the tidyverse is needed (presently just `dplyr`, `tidyr`, and `purrr`).  For more details and examples see https://m-clark.github.io/mixedup/.

## Installation

You can install mixedup from GitHub with `devtools`:

``` r
devtools::install_github('m-clark/mixedup')
```

## Feature list

##### Extract Variance Components

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] brms
- [X] mgcv

##### Extract Random Effects

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] mgcv
- [X] rstanarm
- [X] brms

##### Extract Fixed Effects

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] brms
- [X] mgcv

##### Extract Random Coefficients

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] brms
- [X] mgcv

##### Extract Heterogeneous Variances

- [ ] glmmTMB
- [X] nlme

##### Find Typical

- [X] lme4
- [X] glmmTMB
- [X] nlme
- [X] brms
- [X] mgcv


## Examples

### Setup

```{r mods}
library(lme4)

lmer_model <- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(glmmTMB)

tmb_model <- glmmTMB(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(nlme)

nlme_model <-  nlme(
  height ~ SSasymp(age, Asym, R0, lrc),
  data = Loblolly,
  fixed = Asym + R0 + lrc ~ 1,
  random = Asym ~ 1,
  start = c(Asym = 103, R0 = -8.5, lrc = -3.3)
)

library(brms)

brm_model = brm(
  Reaction ~ Days + (1 + Days | Subject), 
  data = sleepstudy, 
  refresh = -1,
  verbose = FALSE,
  cores = 4
)

library(mgcv)

gam_model = gam(
  Reaction ~  Days +
    s(Subject, bs = 're') +
    s(Days, Subject, bs = 're'),
  data = lme4::sleepstudy,
  method = 'REML'
)
```


### Extract Output from a Mixed Model

```{r extract-re}
library(mixedup)

extract_random_effects(tmb_model)

extract_fixed_effects(nlme_model)

extract_random_coefs(lmer_model)

extract_vc(brm_model, ci_level = .8)

find_typical(gam_model, probs = c(.25, .50, .75))
```

## Consistent output

```{r samestuff}
extract_vc(tmb_model)


extract_vc(nlme_model)


extract_vc(lmer_model)


extract_vc(brm_model)


extract_vc(gam_model)
```



### Code of Conduct

Please note that the 'mixedup' project is released with a [Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md).

By contributing to this project, you agree to abide by its terms.

