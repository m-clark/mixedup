---
output: 
  github_document:
    # toc: true
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = NA,
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# mixedup

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![Travis build status](https://travis-ci.org/m-clark/mixedup.svg?branch=master)](https://travis-ci.org/m-clark/mixedup)
[![AppVeyor build status](https://ci.appveyor.com/api/projects/status/github/m-clark/mixedup?branch=master&svg=true)](https://ci.appveyor.com/project/m-clark/mixedup)
[![Codecov test coverage](https://codecov.io/gh/m-clark/mixedup/branch/master/graph/badge.svg)](https://codecov.io/gh/m-clark/mixedup?branch=master)
<!-- badges: end -->

This package provides extended functionality for mixed models. The goal of `mixedup` is to solve little problems I have had that slip through the cracks from the various modeling packages and others in trying to get presentable output.  Basically the idea is to create (tidy) objects that are easy to use and essentially ready for presentation, as well as *consistent* across packages and across functions.  I use several of these packages (including mgcv) for mixed models, and typically have to do some notable post processing to get some basic output even with `broom::tidy`, and this effort often isn't applicable if I switch to another package for the same type of model.  These functions attempt to address this issue.

For more details and examples see https://m-clark.github.io/mixedup/.


## Installation

You can install mixedup from GitHub with `devtools`:

``` r
devtools::install_github('m-clark/mixedup')
```

## Supported models

- lme4
- glmmTMB
- nlme
- mgcv
- rstanarm *
- brms

\* preliminary support for some functions

## Feature list

- Extract Variance Components
- Extract Random Effects
- Extract Fixed Effects
- Extract Random Coefficients
- Extract Heterogeneous Variances
- Extract Correlation Structure
- Extract Model Data
- Summarize Model
- Find Typical

## Examples

### Setup

```{r mods}
library(lme4)

lmer_model <- lmer(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(glmmTMB)

tmb_model <- glmmTMB(Reaction ~ Days + (1 + Days | Subject), data = sleepstudy)

library(nlme)

nlme_model <-  nlme(
  height ~ SSasymp(age, Asym, R0, lrc),
  data = Loblolly,
  fixed = Asym + R0 + lrc ~ 1,
  random = Asym ~ 1,
  start = c(Asym = 103, R0 = -8.5, lrc = -3.3)
)

library(brms)

brm_model = brm(
  Reaction ~ Days + (1 + Days | Subject), 
  data = sleepstudy, 
  refresh = -1,
  verbose = FALSE,
  cores = 4
)

library(mgcv)

gam_model = gam(
  Reaction ~  Days +
    s(Subject, bs = 're') +
    s(Days, Subject, bs = 're'),
  data = lme4::sleepstudy,
  method = 'REML'
)
```


### Extract Output from a Mixed Model

```{r extract-re, message=TRUE}
library(mixedup)

extract_random_effects(tmb_model)

extract_fixed_effects(nlme_model)

extract_random_coefs(lmer_model)

extract_vc(brm_model, ci_level = .8)

summarize_model(lmer_model, cor_re = TRUE, digits = 1)

find_typical(gam_model, probs = c(.25, .50, .75))
```

### Consistent output

```{r samestuff}
mods = list(
  tmb  = tmb_model,
  lmer = lmer_model, 
  brm  = brm_model,
  gam  = gam_model
)

purrr::map_df(mods, extract_vc, .id = 'model') 
```



## Code of Conduct

Please note that the 'mixedup' project is released with a [Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md).

By contributing to this project, you agree to abide by its terms.

